<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Synthetic Data Spike &#8212; Synthetic Data Tools  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Code" href="code.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="synthetic-data-spike">
<h1>Synthetic Data Spike<a class="headerlink" href="#synthetic-data-spike" title="Link to this heading">¶</a></h1>
<p>Clean way to handle production of high-volume data.</p>
<p>Also.</p>
<p>Clean way to handle Primary/Foriegn Key relationships.</p>
<section id="architecture">
<h2>Architecture<a class="headerlink" href="#architecture" title="Link to this heading">¶</a></h2>
<p>Three parts:</p>
<ul class="simple">
<li><p>Pydantic is expected to provide the essential class definitions.</p></li>
<li><p>Field-level Synthesizers to emit atomic data.</p></li>
<li><p>Model and Schema-level collections.</p></li>
</ul>
</section>
<section id="sample-pydantic-class-definitions">
<h2>Sample Pydantic Class Definitions<a class="headerlink" href="#sample-pydantic-class-definitions" title="Link to this heading">¶</a></h2>
<p>These two classes (with circular references) will be our working
example.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Annotated</span>
<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">Field</span>

<span class="k">class</span> <span class="nc">Employee</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">int</span><span class="p">,</span> <span class="n">Field</span><span class="p">(</span><span class="n">json_schema_extra</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;sql&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="s1">&#39;primary&#39;</span><span class="p">}})</span>
    <span class="p">]</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span> <span class="n">Field</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">hire_date</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">Field</span><span class="p">(</span><span class="n">ge</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">18</span><span class="p">))</span>
    <span class="p">]</span>
    <span class="n">velocity</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">float</span><span class="p">,</span> <span class="n">Field</span><span class="p">(</span><span class="n">ge</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">le</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span>
                     <span class="n">json_schema_extra</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;distribution&quot;</span><span class="p">:</span> <span class="s2">&quot;normal&quot;</span><span class="p">})</span>
    <span class="p">]</span>
    <span class="n">manager</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">int</span><span class="p">,</span> <span class="n">Field</span><span class="p">(</span><span class="n">json_schema_extra</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;sql&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="s1">&#39;foreign&#39;</span><span class="p">,</span> <span class="s1">&#39;reference&#39;</span><span class="p">:</span> <span class="s1">&#39;Manager.id&#39;</span><span class="p">}})</span>
    <span class="p">]</span>


<span class="k">class</span> <span class="nc">Manager</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">int</span><span class="p">,</span> <span class="n">Field</span><span class="p">(</span><span class="n">json_schema_extra</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;sql&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="s1">&#39;primary&#39;</span><span class="p">}})</span>
    <span class="p">]</span>
    <span class="n">employee_id</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">int</span><span class="p">,</span> <span class="n">Field</span><span class="p">(</span><span class="n">json_schema_extra</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;sql&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="s1">&#39;foreign&#39;</span><span class="p">,</span> <span class="s1">&#39;reference&#39;</span><span class="p">:</span> <span class="s1">&#39;Employee.id&#39;</span><span class="p">}})</span>
    <span class="p">]</span>
    <span class="n">department_id</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span> <span class="n">Field</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="p">]</span>
</pre></div>
</div>
</section>
<section id="field-level-data-synthesizer">
<h2>Field-level Data Synthesizer<a class="headerlink" href="#field-level-data-synthesizer" title="Link to this heading">¶</a></h2>
<p>Two aspects of each synthesizer.</p>
<ul class="simple">
<li><p>The essential synth algorithms for various data types</p></li>
<li><p>Behavior of the synth process:</p>
<ul>
<li><p>Independent generation – duplicates are possible.</p></li>
<li><p>Pooled generation – duplicates will be prevented.</p></li>
</ul>
</li>
</ul>
<p>Plus, in order to handle foreign key references. A reference synthesizer
that extracts values from a pooled synthesizer.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">from</span> <span class="nn">annotated_types</span> <span class="kn">import</span> <span class="n">MaxLen</span><span class="p">,</span> <span class="n">MinLen</span><span class="p">,</span> <span class="n">Ge</span><span class="p">,</span> <span class="n">Le</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">attrgetter</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Iterator</span>

<span class="kn">from</span> <span class="nn">pydantic.fields</span> <span class="kn">import</span> <span class="n">FieldInfo</span>

<span class="k">class</span> <span class="nc">Behavior</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">synth</span><span class="p">:</span> <span class="s2">&quot;Synthesizer&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">synth</span> <span class="o">=</span> <span class="n">synth</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">iterator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="o">...</span>

<span class="k">class</span> <span class="nc">Independent</span><span class="p">(</span><span class="n">Behavior</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">synth</span><span class="p">:</span> <span class="s2">&quot;Synthesizer&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">synth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">def</span> <span class="nf">iterator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">synth</span>
    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">synth</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">v</span>

<span class="k">class</span> <span class="nc">Pooled</span><span class="p">(</span><span class="n">Behavior</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">synth</span><span class="p">:</span> <span class="s2">&quot;Synthesizer&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">synth</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">rows</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;no target rows for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">model</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">fill</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Often, these are enough</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pool</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">synth</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># May need a few more</span>
        <span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">rows</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">synth</span><span class="p">(</span><span class="n">count</span><span class="p">))</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pool</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">)</span>
        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">iterator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Synthesizer</span><span class="p">:</span>
    <span class="n">model_ref</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">field_ref</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="s2">&quot;ModelSynthesizer&quot;</span><span class="p">,</span>
        <span class="n">field</span><span class="p">:</span> <span class="n">FieldInfo</span><span class="p">,</span>
        <span class="n">behavior</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Behavior</span><span class="p">]</span> <span class="o">=</span> <span class="n">Independent</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">field</span> <span class="o">=</span> <span class="n">field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">json_schema_extra</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">json_schema_extra</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">behavior</span> <span class="o">=</span> <span class="n">behavior</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">behavior</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">behavior</span><span class="o">.</span><span class="n">iterator</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">behavior</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse the field.&quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate a value.&quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">get_meta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cls_</span><span class="p">,</span> <span class="n">getter</span><span class="p">):</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">metadata</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">cls_</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">matches</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">getter</span><span class="p">(</span><span class="n">matches</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">match</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="n">FieldInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># return issubclass(field.annotation, int)</span>
        <span class="k">return</span> <span class="kc">False</span>
</pre></div>
</div>
<section id="the-model-synthesizer-protocol">
<h3>The Model Synthesizer Protocol<a class="headerlink" href="#the-model-synthesizer-protocol" title="Link to this heading">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">MockModelSynthesizer</span><span class="p">:</span>
    <span class="n">rows</span><span class="p">:</span> <span class="nb">int</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">MockModelSynthesizer</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="string-synthesizer">
<h3>String Synthesizer<a class="headerlink" href="#string-synthesizer" title="Link to this heading">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">string</span>

<span class="k">class</span> <span class="nc">SynthesizeString</span><span class="p">(</span><span class="n">Synthesizer</span><span class="p">):</span>
    <span class="n">domain</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">punctuation</span>
    <span class="n">min_default</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meta</span><span class="p">(</span><span class="n">MinLen</span><span class="p">,</span> <span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;min_length&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meta</span><span class="p">(</span><span class="n">MaxLen</span><span class="p">,</span> <span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;max_length&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_default</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max_length</span> <span class="o">=</span> <span class="mi">32</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_length</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
            <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">domain</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
        <span class="p">])</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">match</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="n">FieldInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">annotation</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">SynthesizeString</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">Employee</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;ZJu,ZWy&#39;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ig</span> <span class="o">=</span> <span class="n">SynthesizeString</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">Employee</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">behavior</span><span class="o">=</span><span class="n">Independent</span><span class="p">)</span>
<span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">ig</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;t%jRJCwdngrbqSn</span><span class="se">\&#39;</span><span class="s1">?&amp;l+WJ!&amp;H$dd&quot;&amp;h&lt;&#39;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pg</span> <span class="o">=</span> <span class="n">SynthesizeString</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">Employee</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">behavior</span><span class="o">=</span><span class="n">Pooled</span><span class="p">)</span>
<span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">pg</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;&lt;r{&#39;&quot;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pg</span><span class="o">.</span><span class="n">behavior</span><span class="o">.</span><span class="n">pool</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;&lt;r{&#39;&quot;</span>
</pre></div>
</div>
</section>
<section id="name-synthesizer">
<h3>Name Synthesizer<a class="headerlink" href="#name-synthesizer" title="Link to this heading">¶</a></h3>
<p>Not very good.</p>
<p>Options</p>
<ol class="arabic simple">
<li><p>get first names from census data; get digraph frequency from last
names.</p></li>
<li><p>Use NLTK digraph frequencies to generate plausible English-like
works.</p></li>
</ol>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SynthesizeName</span><span class="p">(</span><span class="n">SynthesizeString</span><span class="p">):</span>
    <span class="n">domain</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span>
    <span class="n">min_default</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">match</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="n">FieldInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="nb">issubclass</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">annotation</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">json_schema_extra</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">json_schema_extra</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;domain&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;name&quot;</span>
        <span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g2</span> <span class="o">=</span> <span class="n">SynthesizeName</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">Employee</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
<span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">g2</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;Ckbnjjtiiezbvavbatcdm&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Dpuxzzscvtmyzccsnfl&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Movedguauzstngqubtszm&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Zgooedlwgukursklbbwbr&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Yytvpsthmsllancauvihan&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Gjsvhjiutwrsdcalnou&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Iogmrzbafhweikoqoymefcjaaus&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Xbbvwfakdjimbrhmktmunthqcgaokfq&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mkbbfejywjrjfophbhzmukkrcxdozbvdrfdr&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Omfzkuipvh&#39;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="number-synthesizers">
<h3>Number Synthesizers<a class="headerlink" href="#number-synthesizers" title="Link to this heading">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="k">class</span> <span class="nc">SynthesizeNumber</span><span class="p">(</span><span class="n">Synthesizer</span><span class="p">):</span>
    <span class="n">default_distribution</span> <span class="o">=</span> <span class="s2">&quot;uniform&quot;</span>

    <span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meta</span><span class="p">(</span><span class="n">Ge</span><span class="p">,</span> <span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;ge&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meta</span><span class="p">(</span><span class="n">Le</span><span class="p">,</span> <span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;le&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max_value</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_schema_extra</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;distribution&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_distribution</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">SynthesizeInteger</span><span class="p">(</span><span class="n">SynthesizeNumber</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gen</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;uniform&quot;</span><span class="p">:</span> <span class="n">partial</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_value</span><span class="p">),</span>
            <span class="s2">&quot;normal&quot;</span><span class="p">:</span> <span class="n">partial</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">normalvariate</span><span class="p">,</span>
                              <span class="n">mu</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_value</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
                              <span class="n">sigma</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span><span class="p">)</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>
        <span class="p">}[</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_name</span><span class="p">]</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gen</span><span class="p">())</span>
        <span class="k">while</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span> <span class="ow">or</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_value</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gen</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">v</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">match</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="n">FieldInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">annotation</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">SynthesizeFloat</span><span class="p">(</span><span class="n">SynthesizeNumber</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gen</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;uniform&quot;</span><span class="p">:</span> <span class="n">partial</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_value</span><span class="p">),</span>
            <span class="s2">&quot;normal&quot;</span><span class="p">:</span> <span class="n">partial</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">normalvariate</span><span class="p">,</span>
                              <span class="n">mu</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_value</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
                              <span class="n">sigma</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span><span class="p">)</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>
        <span class="p">}[</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_name</span><span class="p">]</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gen</span><span class="p">())</span>
        <span class="k">while</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span> <span class="ow">or</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_value</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gen</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">v</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">match</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="n">FieldInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">annotation</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g3</span> <span class="o">=</span> <span class="n">SynthesizeInteger</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">Employee</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">g3</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1620130150</span><span class="p">,</span>
 <span class="mi">470998807</span><span class="p">,</span>
 <span class="mi">562439064</span><span class="p">,</span>
 <span class="mi">400356711</span><span class="p">,</span>
 <span class="mi">426271425</span><span class="p">,</span>
 <span class="mi">2981324347</span><span class="p">,</span>
 <span class="mi">3892751825</span><span class="p">,</span>
 <span class="mi">612460124</span><span class="p">,</span>
 <span class="mi">514934604</span><span class="p">,</span>
 <span class="mi">910507644</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g4</span> <span class="o">=</span> <span class="n">SynthesizeFloat</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">Employee</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="s1">&#39;velocity&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">g4</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mf">10.333933607379473</span><span class="p">,</span>
 <span class="mf">10.920061248849933</span><span class="p">,</span>
 <span class="mf">14.731619274213585</span><span class="p">,</span>
 <span class="mf">14.332560156503941</span><span class="p">,</span>
 <span class="mf">4.737780386229399</span><span class="p">,</span>
 <span class="mf">5.328339687110079</span><span class="p">,</span>
 <span class="mf">14.014912287900792</span><span class="p">,</span>
 <span class="mf">18.46094923703935</span><span class="p">,</span>
 <span class="mf">13.988209306867594</span><span class="p">,</span>
 <span class="mf">10.27216839327092</span><span class="p">]</span>
</pre></div>
</div>
<p>Expect min 2, max 21, mean <span class="math notranslate nohighlight">\(\tfrac{21 + 2}{2}\)</span> = 11.5, stdev
<span class="math notranslate nohighlight">\(\tfrac{21+2}{6}\)</span> = 3.83</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statistics</span> <span class="kn">import</span> <span class="n">mean</span><span class="p">,</span> <span class="n">stdev</span>
<span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">g4</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">)]</span>
<span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="si">=:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="si">=:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">mean</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="si">=:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">stdev</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="si">=:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;min(s)=4.16, max(s)=20.48, mean(s)=11.79, stdev(s)=3.330&#39;</span>
</pre></div>
</div>
</section>
<section id="date-synthesizer">
<h3>Date Synthesizer<a class="headerlink" href="#date-synthesizer" title="Link to this heading">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SynthesizeDate</span><span class="p">(</span><span class="n">SynthesizeNumber</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meta</span><span class="p">(</span><span class="n">Ge</span><span class="p">,</span> <span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;ge&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meta</span><span class="p">(</span><span class="n">Le</span><span class="p">,</span> <span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;le&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1970</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max_value</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2099</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">31</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_schema_extra</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;distribution&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_distribution</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">min_date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_value</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gen</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;uniform&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_date</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_date</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_date</span><span class="p">,</span>
            <span class="s2">&quot;normal&quot;</span><span class="p">:</span> <span class="n">partial</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">normalvariate</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_date</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_date</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_date</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_date</span><span class="p">)</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>
        <span class="p">}[</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_name</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">match</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="n">FieldInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">annotation</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g5</span> <span class="o">=</span> <span class="n">SynthesizeDate</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">Employee</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="s1">&#39;hire_date&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">g5</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2034</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">458422</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="reference-synthesizer">
<h3>Reference Synthesizer<a class="headerlink" href="#reference-synthesizer" title="Link to this heading">¶</a></h3>
<p>Gets values from another Pooled Synthesizer.</p>
<p>Requies
<code class="docutils literal notranslate"><span class="pre">json_schema_extra={&quot;sql&quot;:</span> <span class="pre">{&quot;key&quot;:</span> <span class="pre">&quot;foreign&quot;,</span> <span class="pre">&quot;reference&quot;:</span> <span class="pre">&quot;model.field&quot;}}</span></code></p>
<p>The <code class="docutils literal notranslate"><span class="pre">source</span></code> attribute is stateful – It’s set to a specific
<code class="docutils literal notranslate"><span class="pre">Synthesizer</span></code> instance.</p>
<p>The update is done as part of preparing a Model iterator – as late as
possible.</p>
<p>The pool of values are generated when a Pooled Synthesizer is built.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SynthesizeReference</span><span class="p">(</span><span class="n">Synthesizer</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="s2">&quot;ModelSynthesizer&quot;</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="n">FieldInfo</span><span class="p">,</span> <span class="n">behavior</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Behavior</span><span class="p">]</span> <span class="o">=</span> <span class="n">Independent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">behavior</span><span class="p">)</span>
        <span class="c1"># &quot;sql&quot;: {&#39;key&#39;: &quot;foreign&quot;, &quot;reference&quot;: &quot;Manager.id&quot;}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_ref</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_schema_extra</span><span class="p">[</span><span class="s2">&quot;sql&quot;</span><span class="p">][</span><span class="s2">&quot;reference&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">:</span> <span class="n">Synthesizer</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate a value.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="c1"># Usually, it&#39;s because the source is not resolved or not a pool.</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;source </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_ref</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">field_ref</span><span class="si">}</span><span class="s2"> not resolved&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="model-synthesizer">
<h2>Model Synthesizer<a class="headerlink" href="#model-synthesizer" title="Link to this heading">¶</a></h2>
<p>A Model is a collection of atomic fields.</p>
<p>The point of a <code class="docutils literal notranslate"><span class="pre">ModelSynthesizer</span></code> is to produce values for a Pydantic
<code class="docutils literal notranslate"><span class="pre">BaseModel</span></code> class.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">synth_class_iter</span><span class="p">(</span><span class="n">base</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Synthesizer</span><span class="p">]</span> <span class="o">=</span> <span class="n">Synthesizer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find all Synthesizers.</span>

<span class="sd">    Tends to be top-down from most general to most specific.</span>
<span class="sd">    It&#39;s more useful reversed, though, starting from most specific.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">yield</span> <span class="n">base</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">base</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">base</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">synth_class_iter</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ModelIter</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="s2">&quot;ModelSynthesizer&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">synth_iter</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">name</span><span class="p">:</span> <span class="nb">iter</span><span class="p">(</span><span class="n">synth</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">synth</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;ModelIter(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">BaseModel</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseModel</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">name</span><span class="p">:</span> <span class="nb">next</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">synth_iter</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">model_class</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;VALIDATION ERROR&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">raise</span>

<span class="k">class</span> <span class="nc">ModelSynthesizer</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cls_</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseModel</span><span class="p">],</span> <span class="n">rows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_class</span> <span class="o">=</span> <span class="n">cls_</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">=</span> <span class="n">rows</span>
        <span class="c1"># Reversed to put subclasses first.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_synth_name_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">synth_class_iter</span><span class="p">())))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_field_synth</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_class</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;ModelSynthesizer(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_class</span><span class="si">}</span><span class="s2">, rows=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">references</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List of field names contain references elsewhere in a schema.&quot;&quot;&quot;</span>
        <span class="n">refs</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">has_reference</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">refs</span>

    <span class="k">def</span> <span class="nf">_make_field_synth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="n">FieldInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Synthesizer</span><span class="p">:</span>
        <span class="n">json_schema_extra</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">json_schema_extra</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="c1"># Rule 0 -- PK&#39;s are pooled, FK&#39;s are references to PK pools.</span>
        <span class="n">behavior</span><span class="p">:</span> <span class="n">Behavior</span>
        <span class="k">if</span> <span class="s2">&quot;sql&quot;</span> <span class="ow">in</span> <span class="n">json_schema_extra</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">json_schema_extra</span><span class="p">[</span><span class="s2">&quot;sql&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;primary&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;primary&quot;</span><span class="p">:</span>
                <span class="c1"># &quot;sql&quot;: {&quot;key&quot;: &quot;primary&quot;} -- Pooled -- based on type.</span>
                <span class="n">behavior</span> <span class="o">=</span> <span class="n">Pooled</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;foreign&quot;</span><span class="p">:</span>
                <span class="c1"># &quot;sql&quot;: {&#39;key&#39;: &quot;foreign&quot;, &quot;reference&quot;: &quot;Manager.id&quot;} -- Independent instance of ``SynthesizeReference``.</span>
                <span class="c1"># Type comes from the referenced source.</span>
                <span class="k">return</span> <span class="n">SynthesizeReference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">Independent</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># TODO: Raise ValueError? Warning?</span>
                <span class="n">behavior</span> <span class="o">=</span> <span class="n">Pooled</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">behavior</span> <span class="o">=</span> <span class="n">Independent</span>

        <span class="n">synth_class</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Synthesizer</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Rule 1 -- json_schema_extra names a synthesizer class to use.</span>
        <span class="k">if</span> <span class="s2">&quot;synthesizer&quot;</span> <span class="ow">in</span> <span class="n">json_schema_extra</span><span class="p">:</span>
            <span class="c1"># Map synthesizer name to implementation classes.</span>
            <span class="n">synth_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synth_name_map</span><span class="p">[</span><span class="n">json_schema_extra</span><span class="p">[</span><span class="s2">&quot;synthesizer&quot;</span><span class="p">]]</span>
            <span class="k">return</span> <span class="n">synth_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">behavior</span><span class="p">)</span>

        <span class="c1"># Rule 2 -- deduce synthesizer from annotation class and json_schema_extra.</span>
        <span class="c1"># Works best if list has subclasses first, superclasses last.</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synth_name_map</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">cls_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synth_name_map</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">cls_</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">field</span><span class="p">):</span>
                <span class="n">synth_class</span> <span class="o">=</span> <span class="n">cls_</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">synth_class</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;no synth class matches </span><span class="si">{</span><span class="n">field</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">synth_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">behavior</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">BaseModel</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">ModelIter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</pre></div>
</div>
<p>Our example has inter-model references. It can’t work.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">emp_synth</span> <span class="o">=</span> <span class="n">ModelSynthesizer</span><span class="p">(</span><span class="n">Employee</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">emp_synth_iter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">emp_synth</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">emp_synth_iter</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">TypeError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">22</span><span class="p">],</span> <span class="n">line</span> <span class="mi">12</span><span class="p">,</span> <span class="ow">in</span> <span class="n">SynthesizeReference</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence</span><span class="p">)</span>
     <span class="mi">11</span> <span class="k">try</span><span class="p">:</span>
<span class="o">---&gt;</span> <span class="mi">12</span>     <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
     <span class="mi">13</span> <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
     <span class="mi">14</span>     <span class="c1"># Usually, it&#39;s because the source is not resolved or not a pool.</span>


<span class="ne">TypeError</span><span class="p">:</span> <span class="s1">&#39;NoneType&#39;</span> <span class="nb">object</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">an</span> <span class="n">iterator</span>


<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>


<span class="ne">ValueError</span>                                <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">33</span><span class="p">],</span> <span class="n">line</span> <span class="mi">4</span>
      <span class="mi">2</span> <span class="n">emp_synth_iter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">emp_synth</span><span class="p">)</span>
      <span class="mi">3</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="o">----&gt;</span> <span class="mi">4</span>     <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">emp_synth_iter</span><span class="p">))</span>


<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">32</span><span class="p">],</span> <span class="n">line</span> <span class="mi">17</span><span class="p">,</span> <span class="ow">in</span> <span class="n">ModelIter</span><span class="o">.</span><span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
     <span class="mi">15</span> <span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseModel</span><span class="p">:</span>
     <span class="mi">16</span>     <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
<span class="o">---&gt;</span> <span class="mi">17</span>         <span class="n">name</span><span class="p">:</span> <span class="nb">next</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
     <span class="mi">18</span>         <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">synth_iter</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
     <span class="mi">19</span>     <span class="p">}</span>
     <span class="mi">20</span>     <span class="k">try</span><span class="p">:</span>
     <span class="mi">21</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">model_class</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>


<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">line</span> <span class="mi">24</span><span class="p">,</span> <span class="ow">in</span> <span class="n">Synthesizer</span><span class="o">.</span><span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
     <span class="mi">23</span> <span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="o">---&gt;</span> <span class="mi">24</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">behavior</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>


<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">31</span><span class="p">,</span> <span class="ow">in</span> <span class="n">Independent</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
     <span class="mi">30</span> <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="o">---&gt;</span> <span class="mi">31</span>     <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">synth</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
     <span class="mi">32</span>     <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
     <span class="mi">33</span>     <span class="k">return</span> <span class="n">v</span>


<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">22</span><span class="p">],</span> <span class="n">line</span> <span class="mi">15</span><span class="p">,</span> <span class="ow">in</span> <span class="n">SynthesizeReference</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence</span><span class="p">)</span>
     <span class="mi">12</span>     <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
     <span class="mi">13</span> <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
     <span class="mi">14</span>     <span class="c1"># Usually, it&#39;s because the source is not resolved or not a pool.</span>
<span class="o">---&gt;</span> <span class="mi">15</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;source </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_ref</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">field_ref</span><span class="si">}</span><span class="s2"> not resolved&quot;</span><span class="p">)</span>


<span class="ne">ValueError</span><span class="p">:</span> <span class="n">source</span> <span class="n">Manager</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="n">resolved</span>
</pre></div>
</div>
</section>
<section id="schema-synthesizer">
<h2>Schema Synthesizer<a class="headerlink" href="#schema-synthesizer" title="Link to this heading">¶</a></h2>
<p>A Schema is a collection of Models.</p>
<p>This is how we handle Foreign Key references to another model’s Primary
Key.</p>
<p>The PK is a <code class="docutils literal notranslate"><span class="pre">Synthesizer</span></code> with <code class="docutils literal notranslate"><span class="pre">Pooled</span></code> behavior.</p>
<p>The FK is a <code class="docutils literal notranslate"><span class="pre">SynthesizeReference</span></code> that extracts values from the pool.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">prepare()</span></code> process resolves references.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SchemaSynthesizer</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schema</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">references</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseModel</span><span class="p">],</span> <span class="n">rows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">ModelSynthesizer</span><span class="p">(</span><span class="n">model_class</span><span class="p">,</span> <span class="n">rows</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">[</span><span class="n">model_class</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span>
        <span class="n">references</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">field_ref</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">model_ref</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">field_ref</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">references</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">references</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">references</span><span class="p">:</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">model_ref</span><span class="p">,</span> <span class="n">field_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">references</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="c1"># DEBUG: print(f&quot;Resolving Reference: {model} {field} refers to {model_ref}.{field_ref}&quot;)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">[</span><span class="n">model_ref</span><span class="p">]</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_ref</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_ref</span><span class="si">}</span><span class="s2"> not in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;can&#39;t resolve </span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2"> ref to </span><span class="si">{</span><span class="n">model_ref</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">field_ref</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">field</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">target</span>
            <span class="c1"># Not needed here because it&#39;s handled when the Pooled Synthesizer is created</span>
            <span class="c1"># Alternative is to defer to here:  target.behavior.fill()</span>

    <span class="k">def</span> <span class="nf">rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseModel</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">BaseModel</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span>
        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">[</span><span class="n">model_class</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">SchemaSynthesizer</span><span class="p">()</span>
<span class="n">s</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Employee</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">s</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Manager</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;Employee&#39;</span><span class="p">])</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;Employee&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ModelSynthesizer(&lt;class &#39;__main__.Employee&#39;&gt;, rows=10)
  id: SynthesizeInteger(ModelSynthesizer(&lt;class &#39;__main__.Employee&#39;&gt;, rows=10), annotation=int required=True json_schema_extra={&#39;sql&#39;: {&#39;key&#39;: &#39;primary&#39;}}, Pooled)
  name: SynthesizeString(ModelSynthesizer(&lt;class &#39;__main__.Employee&#39;&gt;, rows=10), annotation=str required=True metadata=[MaxLen(max_length=40)], Independent)
  hire_date: SynthesizeDate(ModelSynthesizer(&lt;class &#39;__main__.Employee&#39;&gt;, rows=10), annotation=datetime required=True metadata=[Ge(ge=datetime.datetime(2021, 1, 18, 0, 0))], Independent)
  velocity: SynthesizeFloat(ModelSynthesizer(&lt;class &#39;__main__.Employee&#39;&gt;, rows=10), annotation=float required=True json_schema_extra={&#39;distribution&#39;: &#39;normal&#39;} metadata=[Ge(ge=2), Le(le=21)], Independent)
  manager: SynthesizeReference(ModelSynthesizer(&lt;class &#39;__main__.Employee&#39;&gt;, rows=10), annotation=int required=True json_schema_extra={&#39;sql&#39;: {&#39;key&#39;: &#39;foreign&#39;, &#39;reference&#39;: &#39;Manager.id&#39;}}, Independent)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">rows</span><span class="p">(</span><span class="n">Employee</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">id</span><span class="o">=</span><span class="mi">1830925711</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Ew#!yPlKg=KM]j&#39;y;&quot;</span> <span class="n">hire_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2067</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">717739</span><span class="p">)</span> <span class="n">velocity</span><span class="o">=</span><span class="mf">12.643047311951968</span> <span class="n">manager</span><span class="o">=</span><span class="mi">2657133193</span>
<span class="nb">id</span><span class="o">=</span><span class="mi">3042616909</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;THVafJDTtyo?&quot;:Wu=y]P&#39;</span> <span class="n">hire_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2093</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">483257</span><span class="p">)</span> <span class="n">velocity</span><span class="o">=</span><span class="mf">15.138835992381933</span> <span class="n">manager</span><span class="o">=</span><span class="mi">2657133193</span>
<span class="nb">id</span><span class="o">=</span><span class="mi">1220375740</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Yh&#39;o$wMR#}eBu*Jg*rowD&#39;B_I+Lz(C&quot;</span> <span class="n">hire_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2043</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">743324</span><span class="p">)</span> <span class="n">velocity</span><span class="o">=</span><span class="mf">8.228239779243467</span> <span class="n">manager</span><span class="o">=</span><span class="mi">3836089139</span>
<span class="nb">id</span><span class="o">=</span><span class="mi">170845071</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;PXZfmUy&quot;;v;&#39;</span> <span class="n">hire_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2088</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">442257</span><span class="p">)</span> <span class="n">velocity</span><span class="o">=</span><span class="mf">8.386546313449461</span> <span class="n">manager</span><span class="o">=</span><span class="mi">2657133193</span>
<span class="nb">id</span><span class="o">=</span><span class="mi">2734751330</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;-(&#39;</span> <span class="n">hire_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2062</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">322033</span><span class="p">)</span> <span class="n">velocity</span><span class="o">=</span><span class="mf">8.526964708078806</span> <span class="n">manager</span><span class="o">=</span><span class="mi">3836089139</span>
<span class="nb">id</span><span class="o">=</span><span class="mi">2057004573</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;gYjnpM+?+)]}V&lt;EQ&lt;!&quot;e&#39;</span> <span class="n">hire_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2095</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">258200</span><span class="p">)</span> <span class="n">velocity</span><span class="o">=</span><span class="mf">14.546317658884723</span> <span class="n">manager</span><span class="o">=</span><span class="mi">3836089139</span>
<span class="nb">id</span><span class="o">=</span><span class="mi">4105659792</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;|TXPvba^mg+Yx-)ILjiK%!J;@C_W&#39;</span> <span class="n">hire_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2075</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">547362</span><span class="p">)</span> <span class="n">velocity</span><span class="o">=</span><span class="mf">10.00286845639161</span> <span class="n">manager</span><span class="o">=</span><span class="mi">2657133193</span>
<span class="nb">id</span><span class="o">=</span><span class="mi">3285262661</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Ozi~ACEVb!i@Re~#LbKjYla*);&#39;+X@&quot;</span> <span class="n">hire_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2038</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">442073</span><span class="p">)</span> <span class="n">velocity</span><span class="o">=</span><span class="mf">11.966749342732534</span> <span class="n">manager</span><span class="o">=</span><span class="mi">3836089139</span>
<span class="nb">id</span><span class="o">=</span><span class="mi">2054336087</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Yv_gll.wi!%p:V%w|mfpwrnSoA</span><span class="si">%%</span><span class="s1">R.n+pE;k&#39;</span> <span class="n">hire_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2070</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">567657</span><span class="p">)</span> <span class="n">velocity</span><span class="o">=</span><span class="mf">16.75815000413133</span> <span class="n">manager</span><span class="o">=</span><span class="mi">2657133193</span>
<span class="nb">id</span><span class="o">=</span><span class="mi">4136022130</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;+;{q%/[w&#39;</span> <span class="n">hire_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">574306</span><span class="p">)</span> <span class="n">velocity</span><span class="o">=</span><span class="mf">13.998976460717653</span> <span class="n">manager</span><span class="o">=</span><span class="mi">3836089139</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">rows</span><span class="p">(</span><span class="n">Manager</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">id</span><span class="o">=</span><span class="mi">2657133193</span> <span class="n">employee_id</span><span class="o">=</span><span class="mi">3042616909</span> <span class="n">department_id</span><span class="o">=</span><span class="s1">&#39;zsV(|&#39;</span>
<span class="nb">id</span><span class="o">=</span><span class="mi">3836089139</span> <span class="n">employee_id</span><span class="o">=</span><span class="mi">170845071</span> <span class="n">department_id</span><span class="o">=</span><span class="s1">&#39;R?V&#39;</span>
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Synthetic Data Tools</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="context.html">Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="containers.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="components.html">Synthetic Data Tool Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="code.html">Code</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Draft Implementation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#architecture">Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sample-pydantic-class-definitions">Sample Pydantic Class Definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#field-level-data-synthesizer">Field-level Data Synthesizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#model-synthesizer">Model Synthesizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#schema-synthesizer">Schema Synthesizer</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="code.html" title="previous chapter">Code</a></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, S.Lott.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/synthetic_data.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>